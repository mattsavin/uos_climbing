
> uos_climbing@0.0.0 test:backend
> NODE_ENV=test vitest run


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/home/msavin/WebstormProjects/uos_climbing[39m

[90mstdout[2m | tests/backend/gear.test.ts
[22m[39mConnected to the SQLite database.

[90mstdout[2m | tests/backend/gear.test.ts
[22m[39mSeeding default sessions...

[90mstdout[2m | tests/backend/gear.test.ts
[22m[39mSeeding default gear...

[90mstdout[2m | tests/backend/gear.test.ts
[22m[39mRoot admin created.

[90mstdout[2m | tests/backend/gear.test.ts[2m > [22m[2mGear API[2m > [22m[2mshould allow admin to approve gear request
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

[90mstdout[2m | tests/backend/gear.test.ts[2m > [22m[2mGear API[2m > [22m[2mshould show user gear requests
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

[90mstdout[2m | tests/backend/gear.test.ts[2m > [22m[2mGear API[2m > [22m[2mshould allow admin to reject gear request
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

[90mstdout[2m | tests/backend/gear.test.ts[2m > [22m[2mGear API[2m > [22m[2mshould allow admin to mark gear as returned
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

 [32mâœ“[39m tests/backend/gear.test.ts [2m([22m[2m20 tests[22m[2m)[22m[33m 1007[2mms[22m[39m
[90mstdout[2m | tests/backend/sessions.test.ts
[22m[39mConnected to the SQLite database.

[90mstdout[2m | tests/backend/sessions.test.ts[2m > [22m[2mSessions API
[22m[39mSeeding default sessions...

[90mstdout[2m | tests/backend/sessions.test.ts[2m > [22m[2mSessions API
[22m[39mSeeding default gear...

[90mstdout[2m | tests/backend/sessions.test.ts[2m > [22m[2mSessions API
[22m[39mRoot admin created.

 [32mâœ“[39m tests/backend/sessions.test.ts [2m([22m[2m20 tests[22m[2m)[22m[33m 1462[2mms[22m[39m
[90mstdout[2m | tests/backend/middleware.test.ts
[22m[39mConnected to the SQLite database.

[90mstdout[2m | tests/backend/middleware.test.ts[2m > [22m[2mMiddleware Auth API
[22m[39mSeeding default sessions...

[90mstdout[2m | tests/backend/middleware.test.ts[2m > [22m[2mMiddleware Auth API
[22m[39mSeeding default gear...

[90mstdout[2m | tests/backend/middleware.test.ts[2m > [22m[2mMiddleware Auth API
[22m[39mRoot admin created.

 [32mâœ“[39m tests/backend/middleware.test.ts [2m([22m[2m5 tests[22m[2m)[22m[33m 2797[2mms[22m[39m
     [33m[2mâœ“[22m[39m allows committee members to access admin routes [33m 460[2mms[22m[39m
     [33m[2mâœ“[22m[39m blocks regular committee members from creating gear [33m 449[2mms[22m[39m
     [33m[2mâœ“[22m[39m allows Kit & Safety Sec to create gear [33m 456[2mms[22m[39m
[90mstdout[2m | tests/backend/voting.test.ts
[22m[39mConnected to the SQLite database.

[90mstdout[2m | tests/backend/voting.test.ts[2m > [22m[2mVoting API
[22m[39mSeeding default sessions...

[90mstdout[2m | tests/backend/voting.test.ts[2m > [22m[2mVoting API
[22m[39mSeeding default gear...

[90mstdout[2m | tests/backend/voting.test.ts[2m > [22m[2mVoting API
[22m[39mRoot admin created.

 [32mâœ“[39m tests/backend/voting.test.ts [2m([22m[2m7 tests[22m[2m)[22m[33m 2760[2mms[22m[39m
     [33m[2mâœ“[22m[39m should allow application when elections are open [33m 315[2mms[22m[39m
     [33m[2mâœ“[22m[39m should reject double application [33m 319[2mms[22m[39m
     [33m[2mâœ“[22m[39m should process a valid vote [33m 474[2mms[22m[39m
     [33m[2mâœ“[22m[39m should reject double voting [33m 466[2mms[22m[39m
[90mstdout[2m | tests/backend/users.test.ts
[22m[39mConnected to the SQLite database.

[90mstdout[2m | tests/backend/users.test.ts[2m > [22m[2mUsers API
[22m[39mSeeding default sessions...

[90mstdout[2m | tests/backend/users.test.ts[2m > [22m[2mUsers API
[22m[39mSeeding default gear...

[90mstdout[2m | tests/backend/users.test.ts[2m > [22m[2mUsers API
[22m[39mRoot admin created.

 [32mâœ“[39m tests/backend/users.test.ts [2m([22m[2m18 tests[22m[2m)[22m[33m 3795[2mms[22m[39m
     [33m[2mâœ“[22m[39m should update password with correct current password [33m 560[2mms[22m[39m
[90mstdout[2m | tests/backend/auth.test.ts
[22m[39mConnected to the SQLite database.

[90mstdout[2m | tests/backend/auth.test.ts[2m > [22m[2mAuthentication API
[22m[39mSeeding default sessions...

[90mstdout[2m | tests/backend/auth.test.ts[2m > [22m[2mAuthentication API
[22m[39mSeeding default gear...

[90mstdout[2m | tests/backend/auth.test.ts[2m > [22m[2mAuthentication API
[22m[39mRoot admin created.

[90mstdout[2m | tests/backend/auth.test.ts[2m > [22m[2mAuthentication API[2m > [22m[2mEmail Verification[2m > [22m[2mshould verify email with a correct OTP
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

[90mstdout[2m | tests/backend/auth.test.ts[2m > [22m[2mAuthentication API[2m > [22m[2mEmail Verification[2m > [22m[2mshould resend a verification code for an unverified user
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

[90mstdout[2m | tests/backend/auth.test.ts[2m > [22m[2mAuthentication API[2m > [22m[2mEmail Verification[2m > [22m[2mPassword Reset Flow[2m > [22m[2mshould generate a token and return 200 for forgot-password with valid email
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

 [32mâœ“[39m tests/backend/auth.test.ts [2m([22m[2m23 tests[22m[2m)[22m[33m 1696[2mms[22m[39m
[90mstdout[2m | tests/backend/admin.test.ts
[22m[39mConnected to the SQLite database.

[90mstdout[2m | tests/backend/admin.test.ts[2m > [22m[2mAdmin API
[22m[39mSeeding default sessions...

[90mstdout[2m | tests/backend/admin.test.ts[2m > [22m[2mAdmin API
[22m[39mSeeding default gear...

[90mstdout[2m | tests/backend/admin.test.ts[2m > [22m[2mAdmin API
[22m[39mRoot admin created.

[90mstdout[2m | tests/backend/admin.test.ts[2m > [22m[2mAdmin API[2m > [22m[2mshould allow root admin to assign committee roles
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

[90mstdout[2m | tests/backend/admin.test.ts[2m > [22m[2mAdmin API[2m > [22m[2mshould allow root admin to demote a user
[22m[39mEmail sent successfully: { messageId: [32m'mock-id'[39m }

 [32mâœ“[39m tests/backend/admin.test.ts [2m([22m[2m20 tests[22m[2m)[22m[33m 2151[2mms[22m[39m
[90mstdout[2m | tests/backend/email.test.ts[2m > [22m[2mEmail Service[2m > [22m[2mshould successfully send an email
[22m[39mEmail sent successfully: [33mtrue[39m

 [32mâœ“[39m tests/backend/email.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 5[2mms[22m[39m

[2m Test Files [22m [1m[32m8 passed[39m[22m[90m (8)[39m
[2m      Tests [22m [1m[32m114 passed[39m[22m[90m (114)[39m
[2m   Start at [22m 02:59:49
[2m   Duration [22m 20.15s[2m (transform 385ms, setup 193ms, import 2.45s, tests 15.67s, environment 2ms)[22m

